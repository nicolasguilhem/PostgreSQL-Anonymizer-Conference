[%auto-animate]
== PostgreSQL Anonymizer

[%notitle.auto-animate]
=== PostgreSQL Anonymizer

image::images/PostgreSQL-Anonymizer.png[width=60%]

üìò https://postgresql-anonymizer.readthedocs.io/

icon:gitlab[] https://gitlab.com/dalibo/postgresql_anonymizer

[NOTE.speaker]
--
Extension PostgreSQL d'anonymisation et de masquage de donn√©es.

Damien Clochard : Ing√©nieur DBA Postgresql chez Dalibo et membre de l'association PostgreSQL.

- 2018 : initialisation de PostgreSQL Anonymizer
- 2022 : 1.0.0 production ready
- 2025 : 2.0.0 (r√©√©criture en Rust)
--

[%auto-animate]
=== Principes

[.step]
1. Approche d√©clarative
2. Anonymisation by design
3. Anonymisation by default

[NOTE.speaker]
--
Approche d√©clarative via le DDL PostgreSQL : les r√®gles d'anonymisation sont d√©finies avec la d√©finition des tables.

DDL : Data Definition Language : on utilise le language SQL, pas besoin d'apprendre un nouveau langage
--

[%auto-animate]
=== Fonctionnalit√©s

[.step]
* D√©tection des donn√©es sensibles
* Anonymisation statique
* Anonymisation dynamique
* Dump anonymis√©
* Fonctions d'anonymisation (donn√©es al√©atoires, donn√©es m√©lang√©es, fausses donn√©es, g√©n√©ralisation, brouillage partiel, ...)

[NOTE.speaker]
--
Donn√©es g√©n√©r√©es localis√©es
--

[%auto-animate]
=== Installation

[%step]
[source,bash]
----
apt install postgresql_anonymizer_17
----

[%step]
[source,sql]
----
ALTER DATABASE foo SET session_preload_libraries = 'anon';
CREATE EXTENSION anon;
SELECT anon.init();
----

[%step]
[.smaller]
https://postgresql-anonymizer.readthedocs.io/en/stable/INSTALL/

[NOTE.speaker]
--
1. ajout paquet avec repo gitlab dalibo (example pour debian/ubuntu mais doc pour ansible, docker, ...)
2. activation comme n'importe quelle extension
3. Cr√©ation de l'extension
--

////
[%auto-animate]
=== D√©mo 1 : installation

üíª
////

[%auto-animate]
=== D√©claration de la politique d'anonymisation

[%step]
--
**SECURITY LABEL** __[__ **FOR** __provider__ __]__

**ON** __PostgreSQL object__

**IS** { __string_literal__ | **NULL** };
--

[%step]
[source,sql]
----
SECURITY LABEL FOR anon ON ROLE dev IS 'MASKED';

SECURITY LABEL FOR anon ON COLUMN player.last_name
  IS 'MASKED WITH FUNCTION anon.dummy_last_name()';
----

[%step]
[.smaller]
https://postgresql-anonymizer.readthedocs.io/en/stable/dynamic_masking/

[NOTE.speaker]
--
se base sur une fonctionnalit√© de PostgreSQL : les SECURITY LABEL qui permettent une d√©l√©gation des acc√®s √† un syst√®me tiers - selinux
--

[%auto-animate]
=== Mod√®le de donn√©es

image::images/db_schema.svg[width=75%]

[%auto-animate]
=== Quelles donn√©es anonymiser ?

[%step]
[source,sql]
----
SELECT anon.detect();
----

[%step]
[.smaller]
https://postgresql-anonymizer.readthedocs.io/en/stable/detection/

[NOTE.speaker]
--
Se base sur un r√©f√©rentiel.

Ne se substitue pas √† une analyse exhaustive!

üëâ DEMO !
--

[%auto-animate]
=== Les diff√©rentes strat√©gies

[.step]
* Anonymisation statique
* Anonymisation dynamique
* Dump anonymis√©

[NOTE.speaker]
--
* Long mais fait une seule fois pour tous les utilisateurs
* 0 impact sur les utilisateurs non masqu√©s, seuls les utilisateurs masqu√©s sont impact√©s
* 0 impact pour les utilisateurs, seul le demandeur du dump est impact√©
--
